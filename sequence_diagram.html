<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Mediloop – Sequence Diagram</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #f5f5f0;
            font-family: 'Times New Roman', Times, serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 30px 14px;
        }

        h1 {
            font-size: 20px;
            font-weight: bold;
            letter-spacing: 3px;
            text-transform: uppercase;
            margin-bottom: 4px;
            color: #111;
        }

        .sub {
            font-size: 12px;
            color: #666;
            margin-bottom: 16px;
            font-style: italic;
        }

        .wrap {
            background: #fff;
            border: 1px solid #bbb;
            box-shadow: 4px 4px 12px rgba(0, 0, 0, .12);
            overflow-x: auto;
        }

        svg text {
            font-family: 'Times New Roman', Times, serif;
        }
    </style>
</head>

<body>
    <h1>SEQUENCE DIAGRAM</h1>
    <p class="sub">Mediloop Health Management System – Complete System Flow</p>
    <div class="wrap">
        <svg xmlns="http://www.w3.org/2000/svg" width="1060" height="1560" viewBox="0 0 1060 1560">
            <defs>
                <marker id="ms" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
                    <polygon points="0 0,8 3,0 6" fill="#222" />
                </marker>
                <marker id="md" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
                    <polygon points="0 0,8 3,0 6" fill="#666" />
                </marker>
            </defs>

            <!--
  8 Participants  (Caregiver removed)
  x: Patient=55, Admin=160, NGO=268, Frontend=385, Backend=510, MongoDB=640, Firebase=770, Gemini=905
-->

            <!-- ─── TOP BOXES ─── -->
            <rect x="10" y="14" width="88" height="34" fill="#fff" stroke="#333" stroke-width="1.8" rx="2" />
            <text x="54" y="36" text-anchor="middle" font-size="11" font-weight="bold">Patient</text>

            <rect x="114" y="14" width="88" height="34" fill="#fff" stroke="#333" stroke-width="1.8" rx="2" />
            <text x="158" y="36" text-anchor="middle" font-size="11" font-weight="bold">Admin</text>

            <rect x="222" y="14" width="88" height="34" fill="#fff" stroke="#333" stroke-width="1.8" rx="2" />
            <text x="266" y="36" text-anchor="middle" font-size="11" font-weight="bold">NGO</text>

            <rect x="340" y="14" width="92" height="34" fill="#fff" stroke="#333" stroke-width="1.8" rx="2" />
            <text x="386" y="36" text-anchor="middle" font-size="11" font-weight="bold">Frontend</text>

            <rect x="464" y="14" width="96" height="34" fill="#fff" stroke="#333" stroke-width="1.8" rx="2" />
            <text x="512" y="36" text-anchor="middle" font-size="11" font-weight="bold">Backend API</text>

            <rect x="598" y="14" width="88" height="34" fill="#fff" stroke="#333" stroke-width="1.8" rx="2" />
            <text x="642" y="36" text-anchor="middle" font-size="11" font-weight="bold">MongoDB</text>

            <rect x="724" y="14" width="94" height="34" fill="#fff" stroke="#333" stroke-width="1.8" rx="2" />
            <text x="771" y="36" text-anchor="middle" font-size="11" font-weight="bold">Firebase Auth</text>

            <rect x="858" y="14" width="96" height="34" fill="#fff" stroke="#333" stroke-width="1.8" rx="2" />
            <text x="906" y="36" text-anchor="middle" font-size="11" font-weight="bold">Gemini API</text>

            <!-- ─── LIFELINES ─── -->
            <line x1="54" y1="48" x2="54" y2="1498" stroke="#bbb" stroke-width="1" stroke-dasharray="5,4" />
            <line x1="158" y1="48" x2="158" y2="1498" stroke="#bbb" stroke-width="1" stroke-dasharray="5,4" />
            <line x1="266" y1="48" x2="266" y2="1498" stroke="#bbb" stroke-width="1" stroke-dasharray="5,4" />
            <line x1="386" y1="48" x2="386" y2="1498" stroke="#bbb" stroke-width="1" stroke-dasharray="5,4" />
            <line x1="512" y1="48" x2="512" y2="1498" stroke="#bbb" stroke-width="1" stroke-dasharray="5,4" />
            <line x1="642" y1="48" x2="642" y2="1498" stroke="#bbb" stroke-width="1" stroke-dasharray="5,4" />
            <line x1="771" y1="48" x2="771" y2="1498" stroke="#bbb" stroke-width="1" stroke-dasharray="5,4" />
            <line x1="906" y1="48" x2="906" y2="1498" stroke="#bbb" stroke-width="1" stroke-dasharray="5,4" />

            <!-- ════ SECTION 1: LOGIN / REGISTER (y 80–265) ════ -->
            <rect x="0" y="72" width="1060" height="18" fill="#e8e8e8" />
            <text x="530" y="85" text-anchor="middle" font-size="11" font-weight="bold">1. USER LOGIN /
                REGISTRATION</text>

            <line x1="54" y1="106" x2="380" y2="106" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="216" y="102" text-anchor="middle" font-size="10">Fill Register / Login form</text>

            <line x1="386" y1="130" x2="764" y2="130" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="572" y="126" text-anchor="middle" font-size="10">signIn / createUser(email, password)</text>

            <line x1="771" y1="154" x2="393" y2="154" stroke="#666" stroke-width="1.3" stroke-dasharray="5,3"
                marker-end="url(#md)" />
            <text x="579" y="150" text-anchor="middle" font-size="10">Return ID Token (JWT)</text>

            <line x1="386" y1="178" x2="506" y2="178" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="446" y="174" text-anchor="middle" font-size="10">POST /api/auth/sync { token, role }</text>

            <line x1="512" y1="202" x2="636" y2="202" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="574" y="198" text-anchor="middle" font-size="10">upsert User doc</text>

            <line x1="642" y1="224" x2="519" y2="224" stroke="#666" stroke-width="1.3" stroke-dasharray="5,3"
                marker-end="url(#md)" />
            <text x="580" y="220" text-anchor="middle" font-size="10">User saved</text>

            <line x1="512" y1="246" x2="393" y2="246" stroke="#666" stroke-width="1.3" stroke-dasharray="5,3"
                marker-end="url(#md)" />
            <text x="452" y="242" text-anchor="middle" font-size="10">200 OK { userId, role }</text>

            <line x1="386" y1="268" x2="61" y2="268" stroke="#666" stroke-width="1.3" stroke-dasharray="5,3"
                marker-end="url(#md)" />
            <text x="220" y="264" text-anchor="middle" font-size="10">Redirect to Dashboard</text>

            <!-- ════ SECTION 2: MEDICINE & SCHEDULE (y 298–480) ════ -->
            <rect x="0" y="290" width="1060" height="18" fill="#e8e8e8" />
            <text x="530" y="303" text-anchor="middle" font-size="11" font-weight="bold">2. MEDICINE MANAGEMENT &amp;
                SCHEDULE</text>

            <line x1="54" y1="324" x2="380" y2="324" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="216" y="320" text-anchor="middle" font-size="10">Add Medicine</text>

            <line x1="386" y1="346" x2="506" y2="346" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="446" y="342" text-anchor="middle" font-size="10">POST /api/medicines { name, dosage… }</text>

            <line x1="512" y1="368" x2="636" y2="368" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="574" y="364" text-anchor="middle" font-size="10">insert Medicine doc</text>

            <line x1="642" y1="390" x2="393" y2="390" stroke="#666" stroke-width="1.3" stroke-dasharray="5,3"
                marker-end="url(#md)" />
            <text x="516" y="386" text-anchor="middle" font-size="10">201 { medicine } → display list</text>

            <line x1="54" y1="416" x2="380" y2="416" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="216" y="412" text-anchor="middle" font-size="10">Set Reminder / Schedule</text>

            <line x1="386" y1="438" x2="506" y2="438" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="446" y="434" text-anchor="middle" font-size="10">POST /api/schedules { medicineId, freq, times
                }</text>

            <line x1="512" y1="460" x2="636" y2="460" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="574" y="456" text-anchor="middle" font-size="10">insert MedicineSchedule doc</text>

            <line x1="642" y1="480" x2="61" y2="480" stroke="#666" stroke-width="1.3" stroke-dasharray="5,3"
                marker-end="url(#md)" />
            <text x="350" y="476" text-anchor="middle" font-size="10">201 { schedule } → show reminder</text>

            <!-- ════ SECTION 3: HEALTH RECORDS & ANALYTICS (y 510–640) ════ -->
            <rect x="0" y="502" width="1060" height="18" fill="#e8e8e8" />
            <text x="530" y="515" text-anchor="middle" font-size="11" font-weight="bold">3. HEALTH RECORDS &amp;
                ANALYTICS</text>

            <line x1="54" y1="536" x2="380" y2="536" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="216" y="532" text-anchor="middle" font-size="10">Upload Health Record</text>

            <line x1="386" y1="558" x2="506" y2="558" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="446" y="554" text-anchor="middle" font-size="10">POST /api/health-records { title, type, file
                }</text>

            <line x1="512" y1="580" x2="636" y2="580" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="574" y="576" text-anchor="middle" font-size="10">insert HealthRecord doc</text>

            <line x1="642" y1="600" x2="393" y2="600" stroke="#666" stroke-width="1.3" stroke-dasharray="5,3"
                marker-end="url(#md)" />
            <text x="516" y="596" text-anchor="middle" font-size="10">201 { record } saved</text>

            <line x1="54" y1="624" x2="380" y2="624" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="216" y="620" text-anchor="middle" font-size="10">Open Analytics</text>

            <line x1="386" y1="646" x2="506" y2="646" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="446" y="642" text-anchor="middle" font-size="10">GET /api/health-records?userId=…</text>

            <line x1="512" y1="668" x2="636" y2="668" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="574" y="664" text-anchor="middle" font-size="10">query HealthRecord collection</text>

            <line x1="642" y1="688" x2="61" y2="688" stroke="#666" stroke-width="1.3" stroke-dasharray="5,3"
                marker-end="url(#md)" />
            <text x="350" y="684" text-anchor="middle" font-size="10">200 { records[] } → render charts</text>

            <!-- ════ SECTION 4: DRUG INTERACTION & SYMPTOM (y 718–840) ════ -->
            <rect x="0" y="710" width="1060" height="18" fill="#e8e8e8" />
            <text x="530" y="723" text-anchor="middle" font-size="11" font-weight="bold">4. DRUG INTERACTION &amp;
                SYMPTOM CHECKER (AI)</text>

            <line x1="54" y1="744" x2="380" y2="744" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="216" y="740" text-anchor="middle" font-size="10">Enter medicine list</text>

            <line x1="386" y1="766" x2="506" y2="766" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="446" y="762" text-anchor="middle" font-size="10">POST /api/gemini/drug-interactions</text>

            <line x1="512" y1="788" x2="899" y2="788" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="704" y="784" text-anchor="middle" font-size="10">checkDrugInteractions(medicines[])</text>

            <line x1="906" y1="810" x2="393" y2="810" stroke="#666" stroke-width="1.3" stroke-dasharray="5,3"
                marker-end="url(#md)" />
            <text x="648" y="806" text-anchor="middle" font-size="10">Interaction result → 200 OK</text>

            <line x1="54" y1="836" x2="380" y2="836" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="216" y="832" text-anchor="middle" font-size="10">Enter symptoms</text>

            <line x1="386" y1="858" x2="506" y2="858" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="446" y="854" text-anchor="middle" font-size="10">POST /api/gemini/analyze-symptoms</text>

            <line x1="512" y1="880" x2="899" y2="880" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="704" y="876" text-anchor="middle" font-size="10">analyzeSymptoms(symptoms[])</text>

            <line x1="906" y1="902" x2="61" y2="902" stroke="#666" stroke-width="1.3" stroke-dasharray="5,3"
                marker-end="url(#md)" />
            <text x="483" y="898" text-anchor="middle" font-size="10">Symptom analysis → display advice</text>

            <!-- ════ SECTION 5: DONATION FLOW (y 932–1118) ════ -->
            <rect x="0" y="924" width="1060" height="18" fill="#e8e8e8" />
            <text x="530" y="937" text-anchor="middle" font-size="11" font-weight="bold">5. DONATION REQUEST &amp; NGO
                DECISION</text>

            <line x1="54" y1="958" x2="380" y2="958" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="216" y="954" text-anchor="middle" font-size="10">Submit Donation Request</text>

            <line x1="386" y1="980" x2="506" y2="980" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="446" y="976" text-anchor="middle" font-size="10">POST /api/donations { medicines[], ngoId }</text>

            <line x1="512" y1="1002" x2="636" y2="1002" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="574" y="998" text-anchor="middle" font-size="10">save Donation { status: pending }</text>

            <line x1="642" y1="1022" x2="393" y2="1022" stroke="#666" stroke-width="1.3" stroke-dasharray="5,3"
                marker-end="url(#md)" />
            <text x="516" y="1018" text-anchor="middle" font-size="10">201 { donationId } → confirmation shown</text>

            <line x1="266" y1="1048" x2="380" y2="1048" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="322" y="1044" text-anchor="middle" font-size="10">View Donation Requests</text>

            <line x1="386" y1="1070" x2="506" y2="1070" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="446" y="1066" text-anchor="middle" font-size="10">GET /api/donations/ngo/:ngoId</text>

            <line x1="512" y1="1092" x2="636" y2="1092" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="574" y="1088" text-anchor="middle" font-size="10">query pending donations</text>

            <line x1="642" y1="1112" x2="273" y2="1112" stroke="#666" stroke-width="1.3" stroke-dasharray="5,3"
                marker-end="url(#md)" />
            <text x="457" y="1108" text-anchor="middle" font-size="10">200 { donations[] } → NGO reviews</text>

            <line x1="266" y1="1136" x2="380" y2="1136" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="322" y="1132" text-anchor="middle" font-size="10">Accept / Reject Donation</text>

            <line x1="386" y1="1158" x2="506" y2="1158" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="446" y="1154" text-anchor="middle" font-size="10">PUT /api/donations/:id/status</text>

            <line x1="512" y1="1180" x2="636" y2="1180" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="574" y="1176" text-anchor="middle" font-size="10">update Donation status</text>

            <line x1="642" y1="1200" x2="61" y2="1200" stroke="#666" stroke-width="1.3" stroke-dasharray="5,3"
                marker-end="url(#md)" />
            <text x="350" y="1196" text-anchor="middle" font-size="10">Status updated → Patient notified</text>

            <!-- ════ SECTION 6: ADMIN MANAGEMENT (y 1228–1410) ════ -->
            <rect x="0" y="1220" width="1060" height="18" fill="#e8e8e8" />
            <text x="530" y="1233" text-anchor="middle" font-size="11" font-weight="bold">6. ADMIN SYSTEM
                MANAGEMENT</text>

            <line x1="158" y1="1254" x2="380" y2="1254" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="268" y="1250" text-anchor="middle" font-size="10">View Dashboard</text>

            <line x1="386" y1="1276" x2="506" y2="1276" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="446" y="1272" text-anchor="middle" font-size="10">GET /api/admin/stats</text>

            <line x1="512" y1="1298" x2="636" y2="1298" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="574" y="1294" text-anchor="middle" font-size="10">aggregate stats (users, donations…)</text>

            <line x1="642" y1="1318" x2="393" y2="1318" stroke="#666" stroke-width="1.3" stroke-dasharray="5,3"
                marker-end="url(#md)" />
            <text x="516" y="1314" text-anchor="middle" font-size="10">200 { totalUsers, donations… }</text>

            <line x1="158" y1="1344" x2="380" y2="1344" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="268" y="1340" text-anchor="middle" font-size="10">Manage Users / Settings</text>

            <line x1="386" y1="1366" x2="506" y2="1366" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="446" y="1362" text-anchor="middle" font-size="10">PUT/DELETE /api/users | POST
                /api/admin/settings</text>

            <line x1="512" y1="1388" x2="636" y2="1388" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="574" y="1384" text-anchor="middle" font-size="10">update/remove docs</text>

            <line x1="158" y1="1412" x2="380" y2="1412" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="268" y="1408" text-anchor="middle" font-size="10">View System Logs</text>

            <line x1="386" y1="1432" x2="506" y2="1432" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="446" y="1428" text-anchor="middle" font-size="10">GET /api/admin/logs</text>

            <line x1="512" y1="1454" x2="636" y2="1454" stroke="#222" stroke-width="1.3" marker-end="url(#ms)" />
            <text x="574" y="1450" text-anchor="middle" font-size="10">query Log collection</text>

            <line x1="642" y1="1474" x2="165" y2="1474" stroke="#666" stroke-width="1.3" stroke-dasharray="5,3"
                marker-end="url(#md)" />
            <text x="402" y="1470" text-anchor="middle" font-size="10">200 { logs[] } → Admin views logs</text>

            <!-- ─── BOTTOM BOXES ─── -->
            <rect x="10" y="1501" width="88" height="34" fill="#fff" stroke="#333" stroke-width="1.8" rx="2" /><text
                x="54" y="1523" text-anchor="middle" font-size="11" font-weight="bold">Patient</text>
            <rect x="114" y="1501" width="88" height="34" fill="#fff" stroke="#333" stroke-width="1.8" rx="2" /><text
                x="158" y="1523" text-anchor="middle" font-size="11" font-weight="bold">Admin</text>
            <rect x="222" y="1501" width="88" height="34" fill="#fff" stroke="#333" stroke-width="1.8" rx="2" /><text
                x="266" y="1523" text-anchor="middle" font-size="11" font-weight="bold">NGO</text>
            <rect x="340" y="1501" width="92" height="34" fill="#fff" stroke="#333" stroke-width="1.8" rx="2" /><text
                x="386" y="1523" text-anchor="middle" font-size="11" font-weight="bold">Frontend</text>
            <rect x="464" y="1501" width="96" height="34" fill="#fff" stroke="#333" stroke-width="1.8" rx="2" /><text
                x="512" y="1523" text-anchor="middle" font-size="11" font-weight="bold">Backend API</text>
            <rect x="598" y="1501" width="88" height="34" fill="#fff" stroke="#333" stroke-width="1.8" rx="2" /><text
                x="642" y="1523" text-anchor="middle" font-size="11" font-weight="bold">MongoDB</text>
            <rect x="724" y="1501" width="94" height="34" fill="#fff" stroke="#333" stroke-width="1.8" rx="2" /><text
                x="771" y="1523" text-anchor="middle" font-size="11" font-weight="bold">Firebase Auth</text>
            <rect x="858" y="1501" width="96" height="34" fill="#fff" stroke="#333" stroke-width="1.8" rx="2" /><text
                x="906" y="1523" text-anchor="middle" font-size="11" font-weight="bold">Gemini API</text>

            <text x="530" y="1552" text-anchor="middle" font-size="11" font-weight="bold">Mediloop Health Management
                System – Sequence Diagram</text>
        </svg>
    </div>

    <!-- legend -->
    <div
        style="background:#fff;border:1px solid #bbb;padding:10px 24px;display:flex;gap:28px;align-items:center;flex-wrap:wrap;justify-content:center;margin-top:14px;">
        <div style="display:flex;align-items:center;gap:8px;font-size:12px;">
            <svg width="52" height="14">
                <defs>
                    <marker id="l1" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
                        <polygon points="0 0,8 3,0 6" fill="#222" />
                    </marker>
                </defs>
                <line x1="0" y1="7" x2="44" y2="7" stroke="#222" stroke-width="1.5" marker-end="url(#l1)" />
            </svg>
            Request
        </div>
        <div style="display:flex;align-items:center;gap:8px;font-size:12px;">
            <svg width="52" height="14">
                <defs>
                    <marker id="l2" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
                        <polygon points="0 0,8 3,0 6" fill="#666" />
                    </marker>
                </defs>
                <line x1="0" y1="7" x2="44" y2="7" stroke="#888" stroke-width="1.5" stroke-dasharray="5,3"
                    marker-end="url(#l2)" />
            </svg>
            Response
        </div>
        <span style="font-size:12px;">6 Flows: Login · Medicine/Schedule · Health Records/Analytics · Drug
            Interaction/Symptom Checker · Donation · Admin</span>
    </div>
</body>

</html>